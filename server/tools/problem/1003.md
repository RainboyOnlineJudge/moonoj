---
title: 【noip2017模拟题】机关的阴谋
time: 1000
memory: 256
hidden: false
---

## 【问题描述】

“你这家伙，难道是机关派来的间谍吗？”——凶真

“...”——助手

“是我，被机关的间谍抓住了。....。恩，没问题 我会想办法克服这状况”——凶真

“咦，电源？” ——助手

“哼哼，哈哈哈哈哈。特..特别告诉你吧...” ——凶真


世界被分为了n个区域，共n-1条道路连接这些区域，使得任意两个区域存在有且仅有一条路径可以互相到达。每个区域有的安全，有的危险。凶真可以用一个整数描述这个区域的状况。由于机关不断会派出间谍捕捉凶真，凶真需要不断在这些区域间移动。为了更好的逃脱，凶真每次都会给出两个区域，询问这连接这两个区域的路径上有多少状况为x的区域。机关为了捕捉到凶真，会不断改变区域的状况。由于桶子去和女朋友约会了，需要你来编写程序帮助凶真。具体来说，你需要维护两个操作：

 - 1. C i x(0<=x<2^31)  表示将i区域状况变为x
 - 2. Q i j x(0<=x<2^31)  表示询问i区域到j区域的路径上有多少个状态为x的区域

## 【输入】

输入文件名为scheme.in。

第一行有两个整数N,Q，分别表示区域个数和操作个数。下面一行N个整数，表示初始时每个区域的状态。接下来N-1行，每行两个整数x,y，表示x区域与y区域之间有边直接相连。接下来Q行，每行表示一个操作，操作的描述已经在题目描述中给出。

## 【输出】

输出文件名为scheme.out。
对于每个Q输出一行所求的答案。

## 【输入输出样例】


```
| scheme.in      | scheme.out |
|----------------|------------|
| 5 6            | 0          |
| 10 20 30 40 50 | 1          |
| 1 2            | 1          |
| 1 3            | 0          |
| 3 4            |            |
| 3 5            |            |
| Q 2 3 40       |            |
| C 1 40         |            |
| Q 2 3 40       |            |
| Q 4 5 30       |            |
| C 3 10         |            |
| Q 4 5 30       |            |

```

 
## 【数据范围】 

 - 对于30%的数据，1 ≤N,Q≤ 1000；   
 - 对于额外40%的数据，N个区域呈链状  
 - 对于100%的数据， 1 ≤N≤ 100,000；1 ≤Q≤ 200,000； 
