---
title: 【noip2017南宁二中冲刺】一 T3 鏖战字符串
time: 1000
memory: 128
hidden: false
---


## 【问题描述】

Abwad 在 nbc即将完成她的程序的时候，急中生智拔掉了她电脑的电源线，争取到了宝贵的时间。作为著名论文《论 Ctrl-C 与 Ctrl-V 在信息学竞赛中的应用》的作者，他巧妙地使用了这种上古秘术，顺利扳回一城。

在决胜局中，Abwad 决定和 nbc 鏖战字符串，比的是谁能更快地将一个“量子态的字符串”删除。“量子态的字符串”的每个字符都有一个删除难度 dif[i]。“量子态的字符串”非常顽固，只能先分割成若干个子串，然后再通过以下两种方式

删除：

 - 1、假设子串的所有字符的删除难度之和为 x，消耗 a*x2+b 的时间可以将子串扔进回收站。
 - 2、若子串中出现次数最多的字符出现的次数不少于 L 次且不多于 r 次，那么采用“量子态的 py 自动机”算法可以消耗 c*x+d的时间将子串扔进回收站。
 - Abwad 自然知道最少用多少时间就能将字符串删去，因此，他希望你求出删去每个前缀[1,i]的最少用时。

## 【输入格式】

第一行七个整数 n，a，b，c，d，L，r，其中 n 表示字符串的长度

第二行一行一个长度为n的字符串

第三行一行 n 个整数，表示每个字符的删除难度 dif[i]

## 【输出格式】

n行，每行一个整数ans，表示删去前缀[1,i]最短的时间

## 【输入样例 1】

```
5 1 3 1 5 1 1
bwad
1 1 1 1 1
```

## 【输出样例 1】
```
4
7
8
12
13
```
## 【样例 1 解释】

以前缀[1,n]为例，将串分为 a、bwad两个子串，用方法 1 删去第一个子串，用方法2 删去第二个子串，用时1*1+3+1*4+5=13

## 【输入输出样例 2】

见选手目录下的 string/string2.in 和 string/string2.out

## 【限制与约定】

## 【后记】

在 Abwad 和 nbc 同时将最后一个子串删去时，一个带着黑色方框眼镜，方脸，穿着高腰裤的长者，乘着圣洁的祥云，飞进了 YYHS 的机房。在他伟大的思想的启发下，Abwad 和nbc 终于放下了对名利的追逐，找到了人生的意义——吃吃吃。从此，他们过上了幸福快乐的生活……
